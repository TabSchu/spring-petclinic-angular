name: Petclinc frontend CI/CD for develop

on:
  push:
    branches:
      - develop
  pull_request:
    branches:
      - develop

jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Build Docker Image
        run: docker build . -t  spring-petclinic-angular:latest
      - name: Run Docker Image as Container
        run: docker run -p 8080:8080 --detach --name petclinc-frontend-container spring-petclinic-angular:latest
      - name: Install Node.js/npm on Docker Image
        run: docker exec  petclinc-frontend-container  apk add --update npm
      - name: Install Dependencies in Docker Container using npm
        run: docker exec  petclinc-frontend-container npm install
     # - name: install dependencies
     #   run: docker exec  petclinc-frontend-container apk --update add python3  make gcc g++ xvfb
      - name: Run Unit-Tests (Karma)
        run:  docker exec  petclinc-frontend-container  npm run test
      #- name: Run E2E-Tests(cypress)
      #  run: docker exec  petclinc-frontend-container npm run  cypress:run --browser chrome --headless




